$PSDocId: Document Version 1.0 for Runtime Library Version 3.3$

数学ライブラリ（ libmath ）

１ 浮動小数点数
数学ライブラリはIEEE 754準拠の単精度浮動小数点数（float型）と倍精度浮動小数点
数（double型）をサポートします。
PlayStationのCPUは浮動小数点数演算コプロセッサを備えていないため、floatや
double型変数の演算はハードウェアではサポートされていません。よって本ライブラリ
をリンクしサブルーチンコール形式の浮動小数点四則演算パッケージをアプリケーショ
ンに組み込むことによりfloat型とdouble型が使用可能となります。

●float型

	サイズ			４バイト
	有効桁数		６桁（１０進数換算）
	オーバーフロー限界値	2.0**128 = 3.4e38
        アンダーフロー限界値	0.5**126 = 2.2e-38

●double型

	サイズ			８バイト
	有効桁数		１５桁（１０進数換算）
	オーバーフロー限界値	2.0**1024 = 1.8e308
        アンダーフロー限界値	0.5**1022 = 2.2e-308


２ エラー処理	
浮動小数点数演算に関するエラーを通知するため、イベントを使用します。またC標準
スタイルの外部変数によるエラー状態記録もサポートします。

●エラーの種類
ライブラリ内の各関数では引数の範囲テストが行なわれます。関数仕様中で引数の値に
範囲が明記してある関数については、このテストが行なわれ、不適切な値が検出された
場合は「領域エラー」とします。
関数内部および四則演算子を使ったアプリケーション中での演算において、結果が
表現範囲を越えた場合は「範囲エラー」とします。

●エラー時の内部処理
「領域」「範囲」いずれのエラーについても、イベントおよび外部変数へのエラーコー
ド代入による通知が行なわれます。また演算結果については、できる限り演算を継続で
きるよう符号付き無限大値を結果とします。正の無限大のビットパタンは、

float 型：0x7F800000	double型：0x7FF0000000000000

負の無限大は

float 型：0xFF800000	double型：0xFFF0000000000000

となります。
ゼロ除算の返り値は

 NaN（float型：0x7FFFFFFF、double型：0x7FFFFFFFFFFFFFFF）または
-NaN（float型：0xFFFFFFFF、double型：0xFFFFFFFFFFFFFFFF）

です。（NaNは数値ではなく演算サブルーチンが異常を通知するために予約されたビット
パタンです。正常なdouble型変数がNaNと同じビットパタンを格納することはありません。
よってNaNを浮動小数点数演算の対象にすると正しい結果は得られません。）

●エラーイベント
数学ライブラリに属す関数および浮動小数点演算パッケージ（double型の四則演算を実
装）中でエラーが発生すると原因ディスクリプタSwMATHに由来するイベントが発生しま
す。これによりオーバーフローやゼロ除算などを検出しエラー対応することが可能で
す。

●エラー変数
libmat.lib中にはエラーコードを格納するための外部変数math_errnoが定義され、
またインクルードヘッダlibmath.h中にはこの変数がextern宣言されています。
この変数はゼロに初期化されていますが、ライブラリ内でエラーが発生すると
その内容に従ってマクロEDOMまたはERANGE（いずれもsys/errno.hで定義されています）
が格納されます。math_errnoは自動的にゼロリセットされることはありません。
エラー処理後にゼロを明示的に代入してください。


	数学ライブラリにおけるエラー通知
       ==================================================================
	内容		math_errno	イベント
					原因ディスクリプタ  種別
       ------------------------------------------------------------------
	領域エラー	EDOM		SwMATH		    EvSpEDOM
	範囲エラー	ERANGE		SwMATH              EvSpERANGE
       ------------------------------------------------------------------


	
３ 関数一覧

pow	xのy乗
exp	指数
log	自然対数
log10	基底10対数
floor	xより大きくない最大の整数
ceil	xより小さくない最小の整数
fmod	x/yの浮動小数点数余り
modf	整数部と小数部への分割
sin	正弦
cos	余弦
tan	正接
asin	逆正弦
acos	逆余弦
atan	逆正接
atan2	逆正接
sinh	双曲線正弦
cosh	双曲線余弦
tanh	双曲線正接
sqrt	2乗根
hypot	複素数絶対値
ldexp	x×2**n
frexp	正規化小数部と２のべき乗部への分解
fabs	絶対値（マクロ）
printf2		コンソールへの書式出力（float,double型引数対応）
sprintf2	配列への書式出力（float,double型引数対応）



								以上







